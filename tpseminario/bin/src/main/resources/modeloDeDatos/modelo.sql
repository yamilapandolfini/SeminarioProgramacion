CREATE USER 'grupotp' IDENTIFIED BY 'grupotp';
CREATE SCHEMA grupotp;
USE grupotp;

CREATE TABLE USUARIO (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	NOMBRE VARCHAR(50),
	APELLIDO VARCHAR(50),
	EMAIL VARCHAR(150),
	PASSWORD VARCHAR(50),
	PRIMARY KEY (ID)
);
CREATE TABLE ROL (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	NOMBRE VARCHAR(50),
	PRIMARY KEY (ID)
);
CREATE TABLE USUARIO_ROL (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	USUARIO_ID INTEGER NOT NULL,
	ROL_ID INTEGER NOT NULL,
	PRIMARY KEY (ID),
	CONSTRAINT FK_USUARIO_ROL_USUARIO FOREIGN KEY (USUARIO_ID) REFERENCES USUARIO(ID),
	CONSTRAINT FK_USUARIO_ROL_ROL FOREIGN KEY (ROL_ID) REFERENCES ROL(ID)
);
CREATE TABLE MECANICO (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	NOMBRE VARCHAR(50),
	APELLIDO VARCHAR(50),
	TIPODOCUMENTO INTEGER,
	NUMERODOCUMENTO INTEGER,
	LEGAJO INTEGER,
	ESPECIALIDAD INTEGER,	
	PRIMARY KEY (ID)
);
CREATE TABLE CLIENTE (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	NOMBRE VARCHAR(50),
	APELLIDO VARCHAR(50),
	TIPO_DOCUMENTO INTEGER,
	DOCUMENTO INTEGER,
	TELEFONO INTEGER,
	PRIMARY KEY (ID)
);
CREATE TABLE VEHICULO (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	MARCA VARCHAR(50),
	MODELO VARCHAR(50),
	ANOFABRICACION INTEGER,
	PATENTE VARCHAR(15),
	COMPANIASEGURO VARCHAR(50),
	NUMEROPOLIZA VARCHAR(50),
	CLIENTE_ID INTEGER,
	PRIMARY KEY (ID),
	CONSTRAINT FK_VEHICULO_CLIENTE FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID)
);
CREATE TABLE TURNO (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	CLIENTE_ID INTEGER,
	VEHICULO_ID INTEGER,
	MECANICO_ID INTEGER,
	FECHA DATE,
	HORARIO TIME,
	ESTADO INTEGER,
	PRIMARY KEY (ID),
	CONSTRAINT FK_TURNO_CLIENTE FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID),
	CONSTRAINT FK_TURNO_VEHICULO FOREIGN KEY (VEHICULO_ID) REFERENCES VEHICULO(ID),
	CONSTRAINT FK_TURNO_MECANICO FOREIGN KEY (MECANICO_ID) REFERENCES MECANICO(ID)
);
CREATE TABLE INSUMO (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	NOMBRE VARCHAR(50),
	MARCA VARCHAR(50),
	MODELO VARCHAR(50),
	NUMEROPARTE VARCHAR(50),
	COMPANIASEGURO VARCHAR(50),
	NUMEROPOLIZA VARCHAR(50),
	PRIMARY KEY (ID)
);
CREATE TABLE SERVICIOS (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	DESCRIPCION VARCHAR(100),
	PRIMARY KEY (ID)
);
CREATE TABLE SERVICIO_SERVICIOS (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	SERVICIO_ID INTEGER,
	SERVICIOS_ID INTEGER,
	PRIMARY KEY (ID),
	CONSTRAINT FK_SERVICIO_SERVICIOS_SERVICIO FOREIGN KEY (SERVICIO_ID) REFERENCES SERVICIO(ID),
	CONSTRAINT FK_SERVICIO_SERVICIOS_SERVICIOS FOREIGN KEY (SERVICIOS_ID) REFERENCES SERVICIOS(ID)
);
CREATE TABLE SERVICIO_INSUMOS (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	SERVICIO_ID INTEGER,
	INSUMO_ID INTEGER,
	PRIMARY KEY (ID),
	CONSTRAINT FK_SERVICIO_INSUMOS_SERVICIO FOREIGN KEY (SERVICIO_ID) REFERENCES SERVICIO(ID),
	CONSTRAINT FK_SERVICIO_INSUMOS_INSUMOS FOREIGN KEY (INSUMOS_ID) REFERENCES INSUMOS(ID)
);
CREATE TABLE SERVICIO (
	ID INTEGER NOT NULL AUTO_INCREMENT,
	TURNO_ID INTEGER,
	CONFORME TINYINT,
	COMENTARIOS VARCHAR(250),
	PRIMARY KEY (ID),
	CONSTRAINT FK_SERVICIO_TURNO FOREIGN KEY (TURNO_ID) REFERENCES TURNO(ID)
);